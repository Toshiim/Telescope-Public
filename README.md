# Telescope

## Описание проекта

Telescope — система рекомендаций постов из Telegram на основе предпочтений пользователей с использованием LLM и векторных баз данных.

Система собирает сообщения из выбранных пользователем Telegram-каналов, обрабатывает их, сохраняет эмбеддинги в базу данных, а затем на основании семантического анализа рекомендует пользователю наиболее релевантные посты. Пользователь взаимодействует с системой через Telegram-бота: получает рекомендации постов и оценивает их (лайк/дизлайк), влияя на будущие рекомендации.

## Архитектура пайплайна

1. **Сбор данных**:  
   Через TelegramUserAPI сервис получает посты из выбранных каналов в реальном времени.

2. **Очередь сообщений**:  
   Все полученные посты передаются через RabbitMQ для асинхронной обработки.

3. **Обработка сообщений**:  
   Сервис обработки сообщений извлекает текст, генерирует эмбеддинг с помощью LLM (Сейчас используется qwen3:4b)

4. **Хранение данных**:  
   - Метаданные постов и пользовательские реакции сохраняются в базе данных (PostgreSQL через EF).
   - Эмбеддинги сообщений сохраняются в Qdrant.

5. **Система рекомендаций**:  
   Каждое новое сообщение проходит через сервис рекомендаций. Для сообщения сервис рекомендаций используя Recommendation API Qdrant со стратегией Best Score получает коэффициент релевантности, а для пользователя на основании его истории использования бота высчитывается порог. Если коэффициент релевантности выше порога, то сообщение рекомендуется, иначе - нет.

6. **Интеракция с пользователем**:  
   Пользователь получает сообщения в Telegram-боте с возможностью оценивать их. Фидбэк записываеться в БД и учитываеться в следующих рекомендациях.

## Технологии
- RabbitMQ
- MassTransit
- Entity Framework Core
- PostgreSQL
- Qdrant
- Telegram.Bot API
- Telegram.Client.API
- Ollama
- Docker
- Serilog
---

Холодный старт бота для нового пользователя реализован через пересылку сообщений из выбранных каналов, до тех пор пока не будет набрано необходимое число фидбеков от пользователя:
<img width="662" height="1105" alt="image" src="https://github.com/user-attachments/assets/fb279d6f-495e-4321-b3e3-22eaaec7b8b8" />

После того как пользователь отреагирует на достаточное число постов, система начнёт рекомендовать только подходящие посты:
<img width="528" height="1201" alt="image" src="https://github.com/user-attachments/assets/3f6c2326-cf14-4b02-bf0b-476bca8e4789" />


Также реализована возможность семантического поиска по всей коллекции точек для пользователя. С семантически уникальными текстами поиск работает хорошо, способен найти и переформулированные и минимизированные текста: 
<img width="629" height="719" alt="image" src="https://github.com/user-attachments/assets/c84686ac-34ce-42ac-8c5f-9e7fbfa2ebbc" />

